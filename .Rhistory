}) %>% unlist %>% sum
Localidad(18.8207047,	-98.950925)
Localidad(-98.950925, 18.8207047)
revgeocode(c(-98.950925, 18.8207047), output='more')
Localidad <- function(longitud, latitud){
x <- revgeocode(c(longitud, latitud), output = "more")
direccion <- as.character(x$address)
calle <- as.character(x$route)
numero <- as.character(x$street_number)
cp <- as.character(x$postal_code)
colonia <- as.character(x$political)
ciudad <- as.character(x$locality)
estado <- as.character(x$administrative_area_level_1)
pais <- as.character(x$country)
direccion <- ifelse(identical(direccion, character(0)), NA, direccion)
cp <- ifelse(identical(cp, character(0)), NA, cp)
colonia <- ifelse(identical(colonia, character(0)), NA, colonia)
ciudad <- ifelse(identical(ciudad, character(0)), NA, ciudad)
estado <- ifelse(identical(estado, character(0)), NA, estado)
pais <- ifelse(identical(pais, character(0)), NA, pais)
X <- data.frame(direccion, colonia, cp, ciudad, estado, pais,
lat = latitud, long= longitud )
return(X)
}
Localidad(-98.950925, 18.8207047)
geocodeQueryCheck()
Localidad <- function(longitud, latitud){
x <- revgeocode(c(longitud, latitud), output = "more")
direccion <- as.character(x$address)
calle <- as.character(x$route)
numero <- as.character(x$street_number)
cp <- as.character(x$postal_code)
colonia <- as.character(x$political)
ciudad <- as.character(x$locality)
estado <- as.character(x$administrative_area_level_1)
pais <- as.character(x$country)
direccion <- ifelse(identical(direccion, character(0)), NA, direccion)
calle <- ifelse(identical(calle, character(0)), NA, calle)
numero <- ifelse(identical(numero, character(0)), NA, numero)
cp <- ifelse(identical(cp, character(0)), NA, cp)
colonia <- ifelse(identical(colonia, character(0)), NA, colonia)
ciudad <- ifelse(identical(ciudad, character(0)), NA, ciudad)
estado <- ifelse(identical(estado, character(0)), NA, estado)
pais <- ifelse(identical(pais, character(0)), NA, pais)
X <- data.frame(direccion,  colonia, cp, ciudad, estado, pais,
lat = latitud, long= longitud )
return(X)
}
Localidad(-98.950925, 18.8207047)
Localidad <- function(longitud, latitud){
x <- revgeocode(c(longitud, latitud), output = "more")
direccion <- as.character(x$address)
calle <- as.character(x$route)
numero <- as.character(x$street_number)
cp <- as.character(x$postal_code)
colonia <- as.character(x$political)
ciudad <- as.character(x$locality)
estado <- as.character(x$administrative_area_level_1)
pais <- as.character(x$country)
direccion <- ifelse(identical(direccion, character(0)), NA, direccion)
calle <- ifelse(identical(calle, character(0)), NA, calle)
numero <- ifelse(identical(numero, character(0)), NA, numero)
cp <- ifelse(identical(cp, character(0)), NA, cp)
colonia <- ifelse(identical(colonia, character(0)), NA, colonia)
ciudad <- ifelse(identical(ciudad, character(0)), NA, ciudad)
estado <- ifelse(identical(estado, character(0)), NA, estado)
pais <- ifelse(identical(pais, character(0)), NA, pais)
X <- data.frame(direccion,  calle, numero, colonia, cp, ciudad, estado, pais,
lat = latitud, long= longitud )
return(X)
}
Localidad(-98.950925, 18.8207047)
Localidad <- function(longitud, latitud){
x <- revgeocode(c(longitud, latitud), output = "more")
direccion <- as.character(x$address)
calle <- as.character(x$route)
numero <- as.character(x$street_number)
cp <- as.character(x$postal_code)
colonia <- as.character(x$political)
ciudad <- as.character(x$locality)
estado <- as.character(x$administrative_area_level_1)
pais <- as.character(x$country)
direccion <- ifelse(identical(direccion, character(0)), NA, direccion)
calle <- ifelse(identical(calle, character(0)), NA, calle)
numero <- ifelse(identical(numero, character(0)), NA, numero)
cp <- ifelse(identical(cp, character(0)), NA, cp)
colonia <- ifelse(identical(colonia, character(0)), NA, colonia)
ciudad <- ifelse(identical(ciudad, character(0)), NA, ciudad)
estado <- ifelse(identical(estado, character(0)), NA, estado)
pais <- ifelse(identical(pais, character(0)), NA, pais)
X <- data.frame(direccion,  calle, numero, colonia, cp,
ciudad_municipio= ciudad, estado, pais,
lat = latitud, long= longitud )
nombres <- names(X)
nombres <- sapply(nombres, paste, "_", "Verificado", sep=" ")
print(unlist(nombres))
return(X)
}
Localidad(-98.950925, 18.8207047)
nombres <- sapply(nombres, paste, "_", "Verificado", sep="")
Localidad <- function(longitud, latitud){
x <- revgeocode(c(longitud, latitud), output = "more")
direccion <- as.character(x$address)
calle <- as.character(x$route)
numero <- as.character(x$street_number)
cp <- as.character(x$postal_code)
colonia <- as.character(x$political)
ciudad <- as.character(x$locality)
estado <- as.character(x$administrative_area_level_1)
pais <- as.character(x$country)
direccion <- ifelse(identical(direccion, character(0)), NA, direccion)
calle <- ifelse(identical(calle, character(0)), NA, calle)
numero <- ifelse(identical(numero, character(0)), NA, numero)
cp <- ifelse(identical(cp, character(0)), NA, cp)
colonia <- ifelse(identical(colonia, character(0)), NA, colonia)
ciudad <- ifelse(identical(ciudad, character(0)), NA, ciudad)
estado <- ifelse(identical(estado, character(0)), NA, estado)
pais <- ifelse(identical(pais, character(0)), NA, pais)
X <- data.frame(direccion,  calle, numero, colonia, cp,
ciudad_municipio= ciudad, estado, pais,
lat = latitud, long= longitud )
nombres <- names(X)
nombres <- sapply(nombres, paste, "_", "Verificado", sep="")
print(unlist(nombres))
return(X)
}
Localidad(-98.950925, 18.8207047)
Localidad <- function(longitud, latitud){
x <- revgeocode(c(longitud, latitud), output = "more")
direccion <- as.character(x$address)
calle <- as.character(x$route)
numero <- as.character(x$street_number)
cp <- as.character(x$postal_code)
colonia <- as.character(x$political)
ciudad <- as.character(x$locality)
estado <- as.character(x$administrative_area_level_1)
pais <- as.character(x$country)
direccion <- ifelse(identical(direccion, character(0)), NA, direccion)
calle <- ifelse(identical(calle, character(0)), NA, calle)
numero <- ifelse(identical(numero, character(0)), NA, numero)
cp <- ifelse(identical(cp, character(0)), NA, cp)
colonia <- ifelse(identical(colonia, character(0)), NA, colonia)
ciudad <- ifelse(identical(ciudad, character(0)), NA, ciudad)
estado <- ifelse(identical(estado, character(0)), NA, estado)
pais <- ifelse(identical(pais, character(0)), NA, pais)
X <- data.frame(direccion,  calle, numero, colonia, cp,
ciudad_municipio= ciudad, estado, pais,
lat = latitud, long= longitud )
nombres <- names(X)
nombres <- sapply(nombres, paste, "_", "Verificado", sep="")
names(X) <- nombres
return(X)
}
Localidad(-98.950925, 18.8207047)
library(magrittr)
c("data.table", "ggmap", "dplyr", "tidyr",
"lubridate") %>%
sapply(require, character.only=T)
geocodeQueryCheck()
####
Localidad <- function(longitud, latitud){
x <- revgeocode(c(longitud, latitud), output = "more")
direccion <- as.character(x$address)
calle <- as.character(x$route)
numero <- as.character(x$street_number)
cp <- as.character(x$postal_code)
colonia <- as.character(x$political)
ciudad <- as.character(x$locality)
estado <- as.character(x$administrative_area_level_1)
pais <- as.character(x$country)
direccion <- ifelse(identical(direccion, character(0)), NA, direccion)
calle <- ifelse(identical(calle, character(0)), NA, calle)
numero <- ifelse(identical(numero, character(0)), NA, numero)
cp <- ifelse(identical(cp, character(0)), NA, cp)
colonia <- ifelse(identical(colonia, character(0)), NA, colonia)
ciudad <- ifelse(identical(ciudad, character(0)), NA, ciudad)
estado <- ifelse(identical(estado, character(0)), NA, estado)
pais <- ifelse(identical(pais, character(0)), NA, pais)
X <- data.frame(direccion,  calle, numero, colonia, cp,
ciudad_municipio= ciudad, estado, pais,
lat = latitud, long= longitud )
nombres <- names(X)
nombres <- sapply(nombres, paste, "_", "Verificado", sep="")
names(X) <- nombres
return(X)
}
setwd("~/ReposDesarrollo/csvGeoData/")
acopio <- read.csv("acopio/acopio/Centros-de-Acopio.csv",
header = T, stringsAsFactors = F)
acopio <- acopio %>%
data.table %>%
.[, coordenadas := paste(X, Y, sep=", ")]
acopioLocalidad <- mapply("Localidad", longitud= acopio$X, latitud = acopio$Y,
SIMPLIFY = F)
acopioLocalidad2 <- do.call("rbind", acopioLocalidad)
acopioLocalidad2 <- acopioLocalidad2 %>%
data.table %>%
.[, coordenadas := paste(long, lat, sep=", ")]
acopioLocalidad2 <- acopioLocalidad2 %>%
data.table %>%
.[, coordenadas := paste(long_verificado, lat_verificado, sep=", ")]
Localidad(-98.950925, 18.8207047)
acopioLocalidad2 <- acopioLocalidad2 %>%
data.table %>%
.[, coordenadas := paste(long_Verificado, lat_Verificado, sep=", ")]
acopioGeneral <- merge(data.frame(acopio),
data.frame(acopioLocalidad2), by="coordenadas")
acopioGeneral %>%
write.csv("acopio/acopio/acopioVerificado.csv", row.names=F)
refugios <- read.csv("refugios/refugios/Central-Mexico-Earthquake-Shelters.csv",
header = T, stringsAsFactors = F)
refugios <- refugios %>%
data.table %>%
.[, coordenadas := paste(X, Y, sep=", ")]
refugiosLocalidad <- mapply("Localidad", longitud= refugios$X,
latitud = refugios$Y,
SIMPLIFY = F)
archivos <- list.files("edificioColapsado/colaborativo/Mapeo-Colaborativo-19s-DATOS-NECESITAN-VERIFICAR-/",
all.files = T, full.names = T, pattern = "*.csv")
lapply(archivos, function(file){
x <- read.csv(file, stringsAsFactors = F)
dim(x)[1]
}) %>% unlist %>% sum
source('~/.active-rstudio-document')
lapply(archivos, function(file){
x <- read.csv(file, stringsAsFactors = F)
print(grep("X", names(x)))
print(grep("X", names(x)))
})
print(grepl("X", names(x)))
lapply(archivos, function(file){
x <- read.csv(file, stringsAsFactors = F)
print(grepl("X", names(x)))
print(grepl("X", names(x)))
})
lapply(archivos, function(file){
x <- read.csv(file, stringsAsFactors = F)
print(grepl("X", names(x)) %>% table)
print(grepl("X", names(x)) %>% table)
})
lapply(archivos, function(file){
x <- read.csv(file, stringsAsFactors = F)
print(grepl("X", names(x)) %>% table)
print(grepl("Y", names(x)) %>% table)
})
lapply(archivos, function(file){
x <- read.csv(file, stringsAsFactors = F)
x <- x %>%
filter(x!="" | !is.na(x)) %>%
data.table %>%
.[, coordenadas := paste(X, Y, sep=", ")]
dim(x)
})
lapply(archivos, function(file){
x <- read.csv(file, stringsAsFactors = F)
x <- x %>%
filter(X!="" | !is.na(X)) %>%
data.table %>%
.[, coordenadas := paste(X, Y, sep=", ")]
dim(x)
})
archivos
lapply(archivos, function(file){
x <- read.csv(file, stringsAsFactors = F)
print(gsub(".*//","", file))
# x <- x %>%
#   filter(X!="" | !is.na(X)) %>%
#   data.table %>%
#   .[, coordenadas := paste(X, Y, sep=", ")]
#
# xLocalidad <- mapply("Localidad", longitud= x$X,
#                             latitud = x$Y,
#                             SIMPLIFY = F)
# refugiosLocalidad2 <- do.call("rbind", refugiosLocalidad)
#
# xLocalidad2 <- xLocalidad2 %>%
#   data.table %>%
#   .[, coordenadas := paste(long_Verificado, lat_Verificado, sep=", ")]
#
#
# xGeneral <- merge(data.frame(x),
#                          data.frame(xLocalidad2), by="coordenadas")
#
# xGeneral %>%
#   write.csv("refugios/refugios/refugiosVerificado.csv", row.names=F)
#
})
lapply(archivos, function(file){
x <- read.csv(file, stringsAsFactors = F)
# archivo <- (gsub(".*//","", file)
archivo <- (sub(".csv","", archivo, fixed=T)
archivo <- paste0(archivo,  "_Verificado", ".csv")
print(archivo)
# x <- x %>%
#   filter(X!="" | !is.na(X)) %>%
#   data.table %>%
#   .[, coordenadas := paste(X, Y, sep=", ")]
#
# xLocalidad <- mapply("Localidad", longitud= x$X,
#                             latitud = x$Y,
#                             SIMPLIFY = F)
# refugiosLocalidad2 <- do.call("rbind", refugiosLocalidad)
#
# xLocalidad2 <- xLocalidad2 %>%
#   data.table %>%
#   .[, coordenadas := paste(long_Verificado, lat_Verificado, sep=", ")]
#
#
# xGeneral <- merge(data.frame(x),
#                          data.frame(xLocalidad2), by="coordenadas")
#
# xGeneral %>%
#   write.csv("refugios/refugios/refugiosVerificado.csv", row.names=F)
#
})
lapply(archivos, function(file){
x <- read.csv(file, stringsAsFactors = F)
# archivo <- (gsub(".*//","", file)
archivo <- (sub(".csv","", archivo, fixed=T)
archivo <- paste0(archivo,  "_Verificado", ".csv")
print(archivo)
# x <- x %>%
#   filter(X!="" | !is.na(X)) %>%
#   data.table %>%
#   .[, coordenadas := paste(X, Y, sep=", ")]
#
# xLocalidad <- mapply("Localidad", longitud= x$X,
#                             latitud = x$Y,
#                             SIMPLIFY = F)
# refugiosLocalidad2 <- do.call("rbind", refugiosLocalidad)
#
# xLocalidad2 <- xLocalidad2 %>%
#   data.table %>%
#   .[, coordenadas := paste(long_Verificado, lat_Verificado, sep=", ")]
#
#
# xGeneral <- merge(data.frame(x),
#                          data.frame(xLocalidad2), by="coordenadas")
#
# xGeneral %>%
#   write.csv("refugios/refugios/refugiosVerificado.csv", row.names=F)
#
})
lapply(archivos, function(file){
x <- read.csv(file, stringsAsFactors = F)
# archivo <- (gsub(".*//","", file)
archivo <- gsub(".csv","", archivo, fixed=T)
archivo <- paste0(archivo,  "_Verificado", ".csv")
print(archivo)
# x <- x %>%
#   filter(X!="" | !is.na(X)) %>%
#   data.table %>%
#   .[, coordenadas := paste(X, Y, sep=", ")]
#
# xLocalidad <- mapply("Localidad", longitud= x$X,
#                             latitud = x$Y,
#                             SIMPLIFY = F)
# refugiosLocalidad2 <- do.call("rbind", refugiosLocalidad)
#
# xLocalidad2 <- xLocalidad2 %>%
#   data.table %>%
#   .[, coordenadas := paste(long_Verificado, lat_Verificado, sep=", ")]
#
#
# xGeneral <- merge(data.frame(x),
#                          data.frame(xLocalidad2), by="coordenadas")
#
# xGeneral %>%
#   write.csv("refugios/refugios/refugiosVerificado.csv", row.names=F)
#
})
archivo <- gsub(".csv","", file, fixed=T)
lapply(archivos, function(file){
x <- read.csv(file, stringsAsFactors = F)
# archivo <- (gsub(".*//","", file)
archivo <- gsub(".csv","", file, fixed=T)
archivo <- paste0(archivo,  "_Verificado", ".csv")
print(archivo)
# x <- x %>%
#   filter(X!="" | !is.na(X)) %>%
#   data.table %>%
#   .[, coordenadas := paste(X, Y, sep=", ")]
#
# xLocalidad <- mapply("Localidad", longitud= x$X,
#                             latitud = x$Y,
#                             SIMPLIFY = F)
# refugiosLocalidad2 <- do.call("rbind", refugiosLocalidad)
#
# xLocalidad2 <- xLocalidad2 %>%
#   data.table %>%
#   .[, coordenadas := paste(long_Verificado, lat_Verificado, sep=", ")]
#
#
# xGeneral <- merge(data.frame(x),
#                          data.frame(xLocalidad2), by="coordenadas")
#
# xGeneral %>%
#   write.csv("refugios/refugios/refugiosVerificado.csv", row.names=F)
#
})
library(magrittr)
c("data.table", "ggmap", "dplyr", "tidyr",
"lubridate") %>%
sapply(require, character.only=T)
geocodeQueryCheck()
####
Localidad <- function(longitud, latitud){
x <- revgeocode(c(longitud, latitud), output = "more")
direccion <- as.character(x$address)
calle <- as.character(x$route)
numero <- as.character(x$street_number)
cp <- as.character(x$postal_code)
colonia <- as.character(x$political)
ciudad <- as.character(x$locality)
estado <- as.character(x$administrative_area_level_1)
pais <- as.character(x$country)
direccion <- ifelse(identical(direccion, character(0)), NA, direccion)
calle <- ifelse(identical(calle, character(0)), NA, calle)
numero <- ifelse(identical(numero, character(0)), NA, numero)
cp <- ifelse(identical(cp, character(0)), NA, cp)
colonia <- ifelse(identical(colonia, character(0)), NA, colonia)
ciudad <- ifelse(identical(ciudad, character(0)), NA, ciudad)
estado <- ifelse(identical(estado, character(0)), NA, estado)
pais <- ifelse(identical(pais, character(0)), NA, pais)
X <- data.frame(direccion,  calle, numero, colonia, cp,
ciudad_municipio= ciudad, estado, pais,
lat = latitud, long= longitud )
nombres <- names(X)
nombres <- sapply(nombres, paste, "_", "Verificado", sep="")
names(X) <- nombres
return(X)
}
Localidad(-98.950925, 18.8207047)
# revgeocode(c(-98.950925, 18.8207047), output='more')
setwd("~/ReposDesarrollo/csvGeoData/")
acopio <- read.csv("acopio/acopio/Centros-de-Acopio.csv",
header = T, stringsAsFactors = F)
acopio <- acopio %>%
data.table %>%
.[, coordenadas := paste(X, Y, sep=", ")]
acopioLocalidad <- mapply("Localidad", longitud= acopio$X, latitud = acopio$Y,
SIMPLIFY = F)
acopioLocalidad2 <- do.call("rbind", acopioLocalidad)
acopioLocalidad2 <- acopioLocalidad2 %>%
data.table %>%
.[, coordenadas := paste(long_Verificado, lat_Verificado, sep=", ")]
acopioGeneral <- merge(data.frame(acopio),
data.frame(acopioLocalidad2), by="coordenadas")
acopioGeneral %>%
write.csv("acopio/acopio/acopioVerificado.csv", row.names=F)
refugios <- read.csv("refugios/refugios/Central-Mexico-Earthquake-Shelters.csv",
header = T, stringsAsFactors = F)
refugios <- refugios %>%
data.table %>%
.[, coordenadas := paste(X, Y, sep=", ")]
refugiosLocalidad <- mapply("Localidad", longitud= refugios$X,
latitud = refugios$Y,
SIMPLIFY = F)
refugiosLocalidad2 <- do.call("rbind", refugiosLocalidad)
refugiosLocalidad2 <- refugiosLocalidad2 %>%
data.table %>%
.[, coordenadas := paste(long_Verificado, lat_Verificado, sep=", ")]
refugiosGeneral <- merge(data.frame(refugios),
data.frame(refugiosLocalidad2), by="coordenadas")
refugiosGeneral %>%
write.csv("refugios/refugios/refugiosVerificado.csv", row.names=F)
archivos <- list.files("edificioColapsado/colaborativo/Mapeo-Colaborativo-19s-DATOS-NECESITAN-VERIFICAR-/",
all.files = T, full.names = T, pattern = "*.csv")
lapply(archivos, function(file){
x <- read.csv(file, stringsAsFactors = F)
# archivo <- (gsub(".*//","", file)
archivo <- gsub(".csv","", file, fixed=T)
archivo <- paste0(archivo,  "_Verificado", ".csv")
x <- x %>%
filter(X!="" | !is.na(X)) %>%
data.table %>%
.[, coordenadas := paste(X, Y, sep=", ")]
xLocalidad <- mapply("Localidad", longitud= x$X,
latitud = x$Y,
SIMPLIFY = F)
refugiosLocalidad2 <- do.call("rbind", refugiosLocalidad)
xLocalidad2 <- xLocalidad2 %>%
data.table %>%
.[, coordenadas := paste(long_Verificado, lat_Verificado, sep=", ")]
xGeneral <- merge(data.frame(x),
data.frame(xLocalidad2), by="coordenadas")
xGeneral %>%
write.csv(archivo, row.names=F)
})
geocodeQueryCheck()
lapply(archivos, function(file){
x <- read.csv(file, stringsAsFactors = F)
# archivo <- (gsub(".*//","", file)
archivo <- gsub(".csv","", file, fixed=T)
archivo <- paste0(archivo,  "_Verificado", ".csv")
x <- x %>%
filter(X!="" | !is.na(X)) %>%
data.table %>%
.[, coordenadas := paste(X, Y, sep=", ")]
xLocalidad <- mapply("Localidad", longitud= x$X,
latitud = x$Y,
SIMPLIFY = F)
xLocalidad2 <- do.call("rbind", xLocalidad)
xLocalidad2 <- xLocalidad2 %>%
data.table %>%
.[, coordenadas := paste(long_Verificado, lat_Verificado, sep=", ")]
xGeneral <- merge(data.frame(x),
data.frame(xLocalidad2), by="coordenadas")
xGeneral %>%
write.csv(archivo, row.names=F)
print(file)
})
